@model TestingTool.Models.TestCase

@{
    ViewBag.Title = "TestCaseDetails";
}
@{ Guid StructureID = @ViewBag.Structure_IDNumber;}

<h2>TestCaseDetails</h2>

<div>
    <h4>TestCase</h4>
    <h4>StructureID</h4>
    <div id="lab">@StructureID.ToString()</div>
    <hr />
    <dl class="dl-horizontal">
    </dl>
</div>
<p>
    @Html.ActionLink("Edit", "Edit", new { /* id = Model.PrimaryKey */ }) |
    @Html.ActionLink("Back to List", "Index")
</p>
<body onload="ShowTests()">
    <table class="tests" id="table_tests">
        <tr style=" border:1px solid black">
            <th style="width:25%">ID</th>
            <th style="width:25%">Title</th>
            <th style="width:25%">Description</th>
            <th style="width:25%">Action</th>
        </tr>
    </table>
    <div>
        
        <table>
            <tr>
                <td>Title: <input type="text"></td>
                <td>Description: <input type="text"></td>
            </tr>
</table>
</div>
</body>
<script>
    function test(e) {
        var id = $(e).closest("tr").find('td:eq(0)').text();
        alert(id);
      //  window.location.href = "/TestLevels/LevelDetails?parentID=" + id;
    };
    function ShowTests() {
        var dc = $(document.getElementById('lab')).text();
        var ur = "http://localhost:26228/api/TestStructures/"+dc+"/Tests";
        var table = document.getElementById("table_tests");

        $("table.tests tbody tr td").remove();
        $("table.tests tbody tr div").remove();

        $.ajax({
            url: ur,
            type: 'GET',

            success: function (response) {

                var ss = JSON.parse(response);
                var D = ss.tests;

                $.each(D, function (key, value) {
                    var row = table.insertRow();
                    var cell1 = row.insertCell(0);
                    var cell2 = row.insertCell(1);
                    var cell3 = row.insertCell(2);
                    var cell4 = row.insertCell(3);
                    cell1.innerHTML = value.id;
                    cell2.innerHTML = value.test_case_title;
                    cell3.innerHTML = value.test_case_description;
                    cell4.outerHTML = '<div><input type="button" value="Edit" onclick="test(this)"></div>'
                })
            },
            error: function (error) {
                alert(error.statusText);

            }
        });
    };
    </script>